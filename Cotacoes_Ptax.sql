--CONSULTA TABELA COTACOES
SELECT 
CODMOEDA,
DTMOV,
ROUND(COTACAO,4) AS COTACAOCOMPRA,
COTACAO+0.0006 AS COTACAOVENDA,
COALESCE(LAG(COTACAO+0.0006) OVER (ORDER BY DTMOV),(COTACAO+0.0006)) COTACAOVENDA_LAST_DAY,
ROUND((((COTACAO+0.0006)/(COALESCE(LAG(COTACAO+0.0006) OVER (ORDER BY DTMOV),(COTACAO+0.0006))))-1)*100,2) VARIACAO

FROM TSICOT
WHERE 
CODMOEDA = 1
AND DTMOV >'13/03/2023'
ORDER BY
DTMOV DESC
--FETCH FIRST 5 ROWS ONLY